System.register([],(function(){"use strict";return{execute:function(){System.register("project:///assets/scripts/Test.ts",[],(function(e,t){return e("getXYZ",(function(e){for(var t=e.length,i=0,r=t,n=0,o=t,a=0,s=0;s<t;s++)if(e[s]&&e[s].length){i++;for(var l=0;l<t;l++)if(e[s][l]&&e[s][l].length){r=Math.min(r,l),n=Math.max(n,l);for(var c=0;c<t;c++){e[s][l][c]&&(o=Math.min(o,c),a=Math.max(a,c))}}}return{x:n-r+1,y:i,z:a-o+1}})),{setters:[],execute:function(){cc._RF.push(window.module||{},"bfa73odzRJNNoua0fbb94F8","Test"),e("data",[{x:3,y:2,z:7,data:[[],[],[],[],[[],[],[],[0,1,1,1,1,0,0,0,0],[0,0,0,0,1,0,0,0,0],[0,0,0,0,1,1,1,1,0]],[[],[],[],[],[],[0,0,0,0,0,0,0,2,0]]]},{x:4,y:2,z:2,data:[[],[],[],[],[[],[],[],[0,0,0,0,1,0,0,0,0],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,0,0,0,0]],[[],[],[],[0,0,0,0,2,0,0,0,0],[],[],[]]]},{x:4,y:5,z:4,data:[[],[],[[],[],[],[],[],[],[0,0,0,0,0,0,1,0,0]],[[],[],[],[],[],[0,0,0,0,0,0,1,0,0],[0,0,0,0,0,1,0,0,0]],[[],[],[],[],[0,0,0,0,0,0,1,0,0],[0,0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0,0]],[[],[],[],[0,0,0,0,0,0,1,0,0],[0,0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0,0],[0,0,0,1,0,0,0,0,0]],[[],[],[],[0,0,0,0,0,0,2,0,0],[],[],[]]]},{x:5,y:2,z:8,data:[[],[],[],[],[[],[],[0,0,0,0,0,1,1,0,0],[0,0,0,0,0,1,1,0,0],[0,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1],[0,0,0,1,1,0,0,0,0]],[[],[],[],[],[],[0,0,0,0,2,0,0,0,0],[]]]},{x:6,y:3,z:6,data:[[],[],[],[[],[],[],[],[],[],[0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,1,0]],[[],[],[],[],[0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,1,0],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,1,0,2,0]],[[],[],[0,0,1,1,1,1,1,0,0],[0,0,1,0,0,0,1,1,0],[0,0,1,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0],[0,0,1,1,0,0,0,0,0],[0,0,0,1,0,0,0,0,0]]]},{x:7,y:2,z:8,data:[[],[],[],[],[[],[0,0,0,0,0,1,1,0,0],[0,0,0,0,0,1,1,0,0],[0,0,0,0,1,1,1,1,1],[0,1,1,1,1,1,1,1,1],[0,1,0,0,1,1,1,1,0],[0,1,0,0,1,1,1,1,0],[0,1,1,1,1,1,0,0,0]],[[],[],[],[],[0,2,0,0,0,0,0,0,0],[],[],[]]]},{x:4,y:3,z:4,data:[[],[],[],[[],[],[],[],[],[0,0,0,0,0,1,1,0,0],[0,0,0,0,0,1,1,0,0]],[[],[],[],[0,0,0,0,0,1,1,0,0],[0,0,0,0,0,1,1,0,0],[0,0,0,1,1,2,0,0,0],[0,0,0,1,1,0,0,0,0]],[[],[],[],[0,0,0,1,1,0,0,0,0],[0,0,0,1,1,0,0,0,0],[],[]]]},{x:6,y:2,z:6,data:[[],[],[],[],[[],[],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,1,0,0,0],[0,0,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,0],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,1,0,0,0]],[[],[],[],[0,0,0,0,2,0,0,0,0],[],[],[],[]]]},{x:4,y:3,z:6,data:[[],[],[],[[],[],[],[],[0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,1,0],[]],[[],[],[],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,1,2,0,0],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,1,0,0,0]],[[],[],[],[],[0,0,1,1,0,0,0,0,0],[0,0,1,1,0,0,0,0,0],[]]]},{x:7,y:2,z:6,data:[[],[],[],[],[[],[0,0,0,0,0,1,0,0,0],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,1,0,0,0],[0,0,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,0],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,1,0,0,0]],[[],[],[0,0,0,0,0,2,0,0,0],[],[],[],[],[]]]},{x:5,y:2,z:3,data:[[],[],[],[],[[],[],[0,0,0,1,1,1,0,0,0],[0,0,0,1,1,1,0,0,0],[0,0,0,1,1,1,0,0,0],[0,0,0,1,1,1,0,0,0],[0,0,0,1,1,1,0,0,0]],[[],[],[],[],[0,0,0,0,1,0,0,0,0],[],[0,0,0,2,0,0,0,0,0]]]},{x:5,y:2,z:5,data:[[],[],[],[],[[],[],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0]],[[],[],[],[],[0,0,1,1,1,0,0,0,0],[],[0,0,0,0,0,0,2,0,0]]]},{x:5,y:3,z:5,data:[[],[],[],[[],[],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0]],[[],[],[0,0,1,1,0,1,1,0,0],[0,0,1,1,0,0,1,0,0],[0,0,1,1,0,0,0,0,0],[0,0,1,1,0,0,0,0,0],[0,0,1,1,0,0,2,0,0]],[[],[],[],[0,0,0,1,0,0,0,0,0],[],[0,0,1,0,0,0,0,0,0],[]]]},{x:4,y:6,z:5,data:[[],[],[[],[],[],[0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,1,0,0]],[[],[],[],[0,0,0,0,0,1,2,0,0],[0,0,0,0,0,1,0,0,0],[0,0,0,0,0,1,0,0,0],[0,0,0,0,0,1,0,0,0]],[[],[],[],[0,0,0,0,1,0,0,0,0],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,0,0,0,0],[0,0,0,0,1,0,0,0,0]],[[],[],[],[0,0,0,1,0,0,0,0,0],[0,0,0,1,0,0,0,0,0],[0,0,0,1,0,0,0,0,0],[0,0,0,1,0,0,0,0,0]],[[],[],[],[0,0,1,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0]],[[],[],[],[],[0,0,1,0,0,0,0,0,0],[],[]]]},{x:7,y:3,z:5,data:[[],[],[],[[],[0,0,0,1,1,1,1,0,0],[0,0,0,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0]],[[],[],[0,0,0,0,0,1,0,0,0],[],[],[0,0,0,0,1,1,0,0,0],[0,0,0,0,1,0,0,0,0],[0,0,0,0,0,0,2,0,0]],[[],[],[],[],[],[0,0,0,0,1,0,0,0,0],[],[]]]}]),cc._RF.pop()}}})),System.register("project:///assets/scripts/config/KEY.ts",[],(function(e,t){return{setters:[],execute:function(){cc._RF.push(window.module||{},"cbdf7mkd7tN75jV6AnVfbDo","KEY"),e("default",{IS_VOICE:"isVoice",LEVEL:"level",MODE:"mode"}),cc._RF.pop()}}})),System.register("project:///assets/scripts/config/MODE.ts",[],(function(e,t){return{setters:[],execute:function(){cc._RF.push(window.module||{},"50345mHFStBcI3MdqRb4JKp","MODE"),e("MODE",{black:{bg:"#343736",cube:"#95CE5F",title:"#fffff",level:"#ffffff"},white:{bg:"#46D691",cube:"#CACACA",title:"#000000",level:"#000000"}}),cc._RF.pop()}}})),System.register("project:///assets/scripts/gamePlay/CubeCtr.ts",["cc","../lib/Action.ts","../lib/TempConst.ts"],(function(e,t){var i,r,n,o,a,s,l,c,u,p;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,r=e.Component,n=e.ModelComponent,o=e.Color,a=e.Vec3},function(e){s=e.default},function(e){l=e.v3_t}],execute:function(){cc._RF.push(window.module||{},"41c389wVjhLYbFyQNkcUKAF","CubeCtr"),p=i.ccclass,i.property,e("CubeCtr",(c=p("CubeCtr"),c(u=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(n))))._downAct=null,i._downDis=3,i._downTarget=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){}},{key:"addDownAct",value:function(){}}],[{key:"down",value:function(e,t){var i=e.getComponent(n),r=i.material,a=r.passes[0],c=a.getHandle("albedo"),u=new o;a.getUniform(c,u);var p=u.r,d=u.g,b=u.b;s.addAction({updateHandle:function(t,n){var a=r.passes[0],s=a.getHandle("albedo"),c=new o;o.set(c,p,d,b,255-200*t),a.setUniform(s,c),i.material=r,l.set(e.position),l.y-=8*n,e.position=l},overHandle:function(){t&&t()}}).run()}},{key:"showCube",value:function(e,t){var i=e.getComponent(n).material.passes[0],r=i.getHandle("albedo"),c=new o;i.getUniform(r,c);var u=c.r,p=c.g,d=c.b,b=new o;s.addAction({updateHandle:function(t,n){o.set(b,u,p,d,250*t),i.setUniform(r,b),l.set(e.position),l.y=1*(1-t),e.position=l},overHandle:function(){e.position=a.ZERO,o.set(b,u,p,d,255),i.setUniform(r,b),t&&t()}}).run()}}]),t}(r))||u)),cc._RF.pop()}}})),System.register("project:///assets/scripts/gamePlay/CubeMove.ts",["cc","../lib/TempConst.ts"],(function(e,t){var i,r,n,o,a,s,l,c,u,p;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,r=e.Component,n=e.Vec3,o=e.Quat},function(e){a=e.quat_t,s=e.v3_t}],execute:function(){cc._RF.push(window.module||{},"1dcc468y5BDGrx/UaJJ3OHc","CubeMove"),u=i.ccclass,i.property,p=[new n(0,.5,-.5),new n(-.5,.5,0),new n(0,.5,.5),new n(.5,.5,0),new n(0,-.5,-.5),new n(-.5,-.5,0),new n(0,-.5,.5),new n(.5,-.5,0)],e("CubeMove",(l=u("CubeMove"),l(c=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(n))))._testNode=null,i._isMove=!1,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){this._testNode=this.node.parent.getChildByName("test")}},{key:"cubeRotate",value:function(e,t){if(!this._isMove){this._isMove=!0,this.node.removeFromParent();var i=new n(this.node.position),r=new n(this.node.position),l=p[e-1];i.subtract(l),this.node.position=l,this._testNode.position=i,this._testNode.addChild(this.node);var c=0,u=e>4?180:90,d=setInterval(function(){if(c>=u)return clearInterval(d),this.node.removeFromParent(),this.node.rotation=o.IDENTITY,e>4?s.set(-2*l.x,1,-2*l.z):s.set(-2*l.x,0,-2*l.z),r.add(s),this.node.position=r,this._testNode.parent.addChild(this.node),this._testNode.position=n.ZERO,this._testNode.rotation=o.IDENTITY,this._isMove=!1,void(t&&t());c+=2;var i=e%2?e%4==1?1:-1:0,p=e%2?0:e%4==2?-1:1;o.fromEuler(a,2*i,0,2*p),this._testNode.rotate(a)}.bind(this),e>4?1:2)}}},{key:"update",value:function(e){}}]),t}(r))||c)),cc._RF.pop()}}})),System.register("project:///assets/scripts/gamePlay/GameCtr.ts",["cc","../lib/TempConst.ts","../Test.ts","../lib/Action.ts","../lib/InstanceMgr.ts","./CubeCtr.ts","../config/KEY.ts"],(function(e,t){var i,r,n,o,a,s,l,c,u,p,d,b,h,v,f,y,m,g,_,w,C,k,H,D,z,I,T,P,x,R,M,S,A,N,F,U,O,E,L,B,V,G,j,K,Y,W,J;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_temp:void 0,EGameSate:void 0}),{setters:[function(e){i=e._decorator,r=e.Component,n=e.Quat,o=e.Vec3,a=e.Node,s=e.Prefab,l=e.instantiate,c=e.CameraComponent,u=e.AnimationComponent,p=e.Color,d=e.Material,b=e.ModelComponent},function(e){h=e.v2_t,v=e.quat_t,f=e.v3_t},function(e){y=e.data},function(e){m=e.default},function(e){g=e.InstanceMgr},function(e){_=e.CubeCtr},function(e){w=e.default}],execute:function(){cc._RF.push(window.module||{},"34d13NYnH5F262CGRQw5jxI","GameCtr"),Y=i.ccclass,W=i.property,function(e){e[e.LOBBY=0]="LOBBY",e[e.GAMING=1]="GAMING",e[e.GAMEOVER=2]="GAMEOVER"}(J||(J={})),e("GameCtr",(C=Y("GameCtr"),k=W({type:s}),H=W({type:s}),D=W({type:d}),z=W({type:d}),I=W({type:a}),T=W({type:a}),P=W({type:a}),x=W({type:a}),R=W({type:a}),M=W({type:c}),C((A=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(n))),babelHelpers.initializerDefineProperty(i,"cubePrefab",N,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"targetPrefab",F,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"cubeMtl",U,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"targetMtl",O,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"cube_wrap",E,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"gameUI",L,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"testNode",B,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"row_col",V,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"targetNode",G,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"cubeRoot",j,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"camera",K,babelHelpers.assertThisInitialized(i)),i._testNode=null,i._cubes={},i._level=2,i._curState=J.LOBBY,i._isFirst=!0,i.isBuilding=!1,i.targetPos=null,i.gameData=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onLoad",value:function(){g.registerInstance("GameCtr",this)}},{key:"start",value:function(){var e=this,t=localStorage.getItem(w.LEVEL);t?this._level=+t:(this._level=1,localStorage.setItem(w.LEVEL,this._level+"")),setTimeout((function(){e.init()}))}},{key:"init",value:function(){g.UICtr.initLevelTitle(this._level),this.gameData=JSON.parse(JSON.stringify(y[this._level-1])),this.buildCube()}},{key:"startGame",value:function(){this.curState=J.GAMING,g.TargetCtr.enabled=!0,g.UICtr.hideStartUI(),this._isFirst?this._isFirst=!1:this.init(),g.MusicCtr.play("start")}},{key:"reStart",value:function(){g.UICtr.hideOverUI(),this.curState=J.GAMING,g.TargetCtr.enabled=!0,this.init(),g.MusicCtr.play("start")}},{key:"gameOver",value:function(e){g.TargetCtr.enabled=!1,e&&e.then((function(){g.UICtr.showOverUI()}))}},{key:"onTouchMove",value:function(e,t){e.getDelta(h),0!=h.x&&(n.fromEuler(v,0,.75*h.x,0),this.cube_wrap.rotate(v))}},{key:"buildCube",value:function(){var e=this;this.isBuilding=!0,this.cube_wrap.removeAllChildren();var t=this.gameData,i=t.data,r=t.x,n=t.y,a=t.z;this._cubes={};for(var s=i,c=this.row_col/2-(r%2?.5:0),u=this.row_col/2-(n%2?.5:0),p=this.row_col/2-(a%2?.5:0),d=[],h=0;h<this.row_col;h++)if(s[h]&&s[h].length)for(var v=0;v<this.row_col;v++)if(s[h][v]&&s[h][v].length)for(var y=0;y<this.row_col;y++){var m=s[h][v][y];if(m)if(f.set(v-c,h-u,y-p),m%2){var w=l(this.cubePrefab);w.getChildByName("Cube").getComponent(b).material=this.cubeMtl,w.position=f,d.push(w),this._cubes["".concat(v).concat(h).concat(y)]=w}else this.targetPos=new o(v,h,y),g.TargetCtr.init(f)}g.TargetCtr.node.getChildByName("Cube").active=!1,d.push(g.TargetCtr.node);var C=d.length;d.reduce((function(t,i,r){return t.then((function(){return new Promise((function(t,n){r!==C-1?e.cube_wrap.addChild(i):e.isBuilding=!1;var o=i.getChildByName("Cube");o.active=!0,_.showCube(o),setTimeout(t,40)}))}))}),Promise.resolve())}},{key:"destroyCube",value:function(e){var t=this,i=this.targetPos;f.set(i),f.y--;var r="".concat(f.x).concat(f.y).concat(f.z),n=this._cubes[r];this.gameData.data[f.y][f.x][f.z]=0,delete this._cubes[r],_.down(n.getChildByName("Cube"),(function(){n.destroy()})),e%2?i.z+=e%4==3?-1:1:i.x+=e%4?1:-1,e>4&&e<9?i.y++:e>8&&i.y--,setTimeout((function(){t.checkGameOver()}),200)}},{key:"nextLevel",value:function(){this._level=this._level+1>y.length?y.length:this._level+1,localStorage.setItem(w.LEVEL,this._level+"")}},{key:"checkGameOver",value:function(){var e=this;if(1===Object.keys(this._cubes).length)return console.log("nextLevel"),this.nextLevel(),void this.overShake().then((function(t){var i=null,r=new Promise((function(e){return i=e}));e.gameOver(r);var n=[g.TargetCtr.overAni()];setTimeout((function(){n.push(g.ParticleCtr.playOverParticle()),Promise.all(n).then(i)}),1e3)}));for(var t=0,i=1;i<=4;i++){var r=g.TargetCtr.getCubeAround(i);r[0]&&!r[1]?t=i:r[1]&&!r[2]?t=i+4:!r[3]||r[1]||r[0]||(t=i+8)}if(!t){console.log("gameOver");var n=null,o=new Promise((function(e){return n=e}));this.gameOver(o),this.dieAni().then(n)}}},{key:"dieAni",value:function(){var e=this,t=this.camera.getComponent(u),i=(new p).set(this.camera.color);return t.play(),new Promise((function(r,n){setTimeout((function(){r(),e.camera.color=i,t.stop()}),1500)}))}},{key:"overShake",value:function(){var e=this,t=this.cubeRoot.getComponent(u);return f.set(this.cubeRoot.position),t.play(),new Promise((function(i,r){setTimeout((function(){i(),e.cubeRoot.position=f,t.stop()}),1500)}))}},{key:"modeChange",value:function(e,t){console.log("modeChange"),this.cubeMtl.setProperty("albedo",new p(e.cube)),t&&this.buildCube()}},{key:"update",value:function(e){m.update(e)}},{key:"curState",set:function(e){switch(e){case J.LOBBY:case J.GAMING:case J.GAMEOVER:}this._curState=e}}]),t}(r),N=babelHelpers.applyDecoratedDescriptor(A.prototype,"cubePrefab",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=babelHelpers.applyDecoratedDescriptor(A.prototype,"targetPrefab",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=babelHelpers.applyDecoratedDescriptor(A.prototype,"cubeMtl",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=babelHelpers.applyDecoratedDescriptor(A.prototype,"targetMtl",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=babelHelpers.applyDecoratedDescriptor(A.prototype,"cube_wrap",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=babelHelpers.applyDecoratedDescriptor(A.prototype,"gameUI",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=babelHelpers.applyDecoratedDescriptor(A.prototype,"testNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=babelHelpers.applyDecoratedDescriptor(A.prototype,"row_col",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 9}}),G=babelHelpers.applyDecoratedDescriptor(A.prototype,"targetNode",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=babelHelpers.applyDecoratedDescriptor(A.prototype,"cubeRoot",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=babelHelpers.applyDecoratedDescriptor(A.prototype,"camera",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=A))||S)),cc._RF.pop()}}})),System.register("project:///assets/scripts/gamePlay/MusicCtr.ts",["cc","../lib/InstanceMgr.ts"],(function(e,t){var i,r,n,o,a,s,l,c,u,p,d;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,r=e.Component,n=e.AudioClip},function(e){o=e.InstanceMgr}],execute:function(){cc._RF.push(window.module||{},"6b312inzlZClKCPawU6SJP6","MusicCtr"),p=i.ccclass,d=i.property,e("MusicCtr",(a=p("MusicCtr"),s=d([n]),a((c=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(n))),babelHelpers.initializerDefineProperty(i,"music",u,babelHelpers.assertThisInitialized(i)),i._isCloseVoice=!1,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onLoad",value:function(){var e=localStorage.getItem("isVocie");this._isCloseVoice=!!e,o.registerInstance("MusicCtr",this)}},{key:"start",value:function(){}},{key:"play",value:function(e){this._isCloseVoice||this.music.find((function(t){return t.name===e})).play()}},{key:"toogleVoice",value:function(){this._isCloseVoice=!this._isCloseVoice,localStorage.setItem("isVoice",this._isCloseVoice?"1":""),o.UICtr.toogleVoiceIcon(this._isCloseVoice),this.play("click")}}]),t}(r),u=babelHelpers.applyDecoratedDescriptor(c.prototype,"music",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=c))||l)),cc._RF.pop()}}})),System.register("project:///assets/scripts/gamePlay/ParticleCtr.ts",["cc","../lib/InstanceMgr.ts"],(function(e,t){var i,r,n,o,a,s,l,c,u,p,d;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,r=e.Component,n=e.ParticleSystemComponent},function(e){o=e.InstanceMgr}],execute:function(){cc._RF.push(window.module||{},"26e14l26PlNDK8MWAXUGuw4","ParticleCtr"),p=i.ccclass,d=i.property,e("ParticleCtr",(a=p("ParticleCtr"),s=d({type:n}),a((c=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(n))),babelHelpers.initializerDefineProperty(i,"over",u,babelHelpers.assertThisInitialized(i)),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){o.registerInstance("ParticleCtr",this)}},{key:"playOverParticle",value:function(){var e=this;return new Promise((function(t){e.over.forEach((function(e){e.enabled=!1,e.enabled=!0})),setTimeout(t,3e3)}))}}]),t}(r),u=babelHelpers.applyDecoratedDescriptor(c.prototype,"over",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=c))||l)),cc._RF.pop()}}})),System.register("project:///assets/scripts/gamePlay/TargetCtr.ts",["cc","../lib/TempConst.ts","../lib/Action.ts","../lib/InstanceMgr.ts"],(function(e,t){var i,r,n,o,a,s,l,c,u,p,d,b,h,v,f,y,m,g,_,w,C,k,H,D,z,I;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,r=e.Component,n=e.Node,o=e.systemEvent,a=e.SystemEventType,s=e.ModelComponent,l=e.AnimationComponent,c=e.ParticleSystemComponent,u=e.Quat,p=e.Vec3,d=e.Color},function(e){b=e.v3_t},function(e){h=e.default},function(e){v=e.InstanceMgr}],execute:function(){cc._RF.push(window.module||{},"51090x6WYNNipQMIjxIjiEh","TargetCtr"),k=i.ccclass,H=i.property,D=new p,z=new u,I=[new p(0,-.5,.5),new p(.5,-.5,0),new p(0,-.5,-.5),new p(-.5,-.5,0),new p(0,.5,.5),new p(.5,.5,0),new p(0,.5,-.5),new p(-.5,.5,0),new p(0,-.5,.5),new p(.5,-.5,0),new p(0,-.5,-.5),new p(-.5,-.5,0)],e("TargetCtr",(f=k("CubeRotate"),y=H({type:l}),m=H({type:n}),f((_=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(n))))._onceAngle=-Math.PI/2,i._forwardAnchor=new p(0,-.5,.5),i._startPos=new p,i._startRot=new u,i._anchorPos=new p,i._curRotAxis=p.UNIT_X,i._cube=null,i._trailParCom=null,i._forward=1,i._rotateAct=null,babelHelpers.initializerDefineProperty(i,"overAnicom",w,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"trailParticle",C,babelHelpers.assertThisInitialized(i)),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onLoad",value:function(){v.registerInstance("TargetCtr",this),this._cube=this.node.getChildByName("Cube"),this._trailParCom=this.trailParticle.getComponent(c)}},{key:"start",value:function(){this.addRotaeAct()}},{key:"onEnable",value:function(){o.on(a.TOUCH_MOVE,this.onTouchMove,this),o.on(a.TOUCH_END,this.onTouchEnd,this)}},{key:"onDisable",value:function(){o.off(a.TOUCH_MOVE,this.onTouchMove,this),o.off(a.TOUCH_END,this.onTouchEnd,this)}},{key:"onTouchMove",value:function(e,t){}},{key:"onTouchEnd",value:function(e,t){if(console.log("touch"),!this._rotateAct.isMove){var i=e.getLocation(),r=e.getStartLocation(),n=i.subtract(r),o=1;n.x>0&&n.y<0?o=2:n.x>0&&n.y>0?o=3:n.x<0&&n.y>0&&(o=4);var a=this.getCubeAround(o),s=0;a[0]&&!a[1]?s=o:a[1]&&!a[2]?s=o+4:!a[3]||a[1]||a[0]||(s=o+8),s&&(this.rotateForward(s),v.GameCtr.destroyCube(s),v.MusicCtr.play("move"))}}},{key:"init",value:function(e){var t=this._cube.getComponent(s),i=t.material,r=i.passes[0],n=r.getHandle("albedo"),o=new d;r.getUniform(n,o),o.a=0,r.setUniform(n,o),t.material=i,this.node.position=e,this.node.scale=b.set(1,1,1),this._cube.position=p.ZERO}},{key:"hide",value:function(){}},{key:"rotateAround",value:function(e,t,i,r,n){u.fromAxisAngle(z,r,n),p.subtract(D,e,i),p.transformQuat(D,D,z),p.add(D,i,D),this.node.setPosition(D),u.rotateAround(z,t,r,n),u.normalize(z,z),this._cube.setRotation(z)}},{key:"rotateForward",value:function(e){this._forward=e,this._forwardAnchor=I[e-1],this._curRotAxis=e%2?p.UNIT_X:p.UNIT_Z;var t=e>4?Math.PI:Math.PI/2;this._onceAngle=e%4==1||e%4==0?t:-t,this.node.getPosition(this._startPos),p.add(this._anchorPos,this._forwardAnchor,this._startPos),this._cube.getRotation(this._startRot),this._rotateAct.run()}},{key:"getCubeAround",value:function(e){var t,i=v.GameCtr.gameData.data,r=v.GameCtr.targetPos;switch(e){case 1:t=new p(r.x,r.y,r.z+1);break;case 2:t=new p(r.x+1,r.y,r.z);break;case 3:t=new p(r.x,r.y,r.z-1);break;case 4:t=new p(r.x-1,r.y,r.z)}var n=[t.y-1,t.y,t.y+1,t.y-2],o=[];return n.forEach((function(e){i[e]&&i[e][t.x]&&1===i[e][t.x][t.z]?o.push(1):o.push(0)})),o}},{key:"overAni",value:function(){var e=this;return new Promise((function(t,i){e.overAnicom.play(),e.overAnicom.on("play",t,e)}))}},{key:"addRotaeAct",value:function(){var e=this;this._rotateAct=h.addAction({updateHandle:function(t){var i=t*e._onceAngle;e.rotateAround(e._startPos,e._startRot,e._anchorPos,e._curRotAxis,i)},overHandle:function(){e.showTrail(),e.rotateAround(e._startPos,e._startRot,e._anchorPos,e._curRotAxis,e._onceAngle)},autoMove:!1})}},{key:"showTrail",value:function(){var e=this._forward%4;1===e?(b.set(0,0,-.5),this.trailParticle.setRotationFromEuler(0,0,0)):2===e?(b.set(-.5,0,0),this.trailParticle.setRotationFromEuler(0,90,0)):3===e?(b.set(0,0,.5),this.trailParticle.setRotationFromEuler(0,180,0)):(b.set(.5,0,0),this.trailParticle.setRotationFromEuler(0,-90,0)),this.trailParticle.position=b,this._trailParCom.enabled=!1,this._trailParCom.enabled=!0}},{key:"down",value:function(){}},{key:"update",value:function(e){}}]),t}(r),w=babelHelpers.applyDecoratedDescriptor(_.prototype,"overAnicom",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=babelHelpers.applyDecoratedDescriptor(_.prototype,"trailParticle",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=_))||g)),cc._RF.pop()}}})),System.register("project:///assets/scripts/gamePlay/WxRankList.ts",["cc","../lib/InstanceMgr.ts"],(function(e,t){var i,r,n,o,a,s,l,c,u,p,d,b,h,v,f,y,m,g,_,w,C;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,r=e.Component,n=e.Texture2D,o=e.Node,a=e.SpriteComponent},function(e){s=e.InstanceMgr}],execute:function(){cc._RF.push(window.module||{},"c1469sYWDpMtJccU8XBH61a","WxRankList"),g=i.ccclass,_=i.property,w={OpenDataKeys:{InitKey:"initKey",Grade:"testkey",LevelKey:"reachlevel",ScoreKey:"levelScore"},DomainAction:{FetchFriend:"FetchFriend",FetchGroup:"FetchGroup",FetchFriendLevel:"FetchFriendLevel",FetchFriendScore:"FetchFriendScore",HorConmpar:"HorConmpar",Paging:"Paging",Scrolling:"Scrolling"}},C={curLevel:1,getScore:function(e){return 1}},e("WxRankList",(l=g("WxRankList"),c=_({type:o}),u=_({type:o}),p=_({type:o}),d=_({type:o}),l((h=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(n))),babelHelpers.initializerDefineProperty(i,"rankRender",v,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"rankListNode",f,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"rankBgNode",y,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"touchLayer",m,babelHelpers.assertThisInitialized(i)),i.enableScroll=!0,i._timeCounter=0,i.rendInterval=.5,i.rankTexture=null,i.rankSpriteFrame=null,i.closeBackRank=0,i.scale=1,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onLoad",value:function(){s.registerInstance("WxRankList",this),this.rankTexture=new n,this.rankSpriteFrame=new cc.SpriteFrame,this.resizeSharedCanvas(this.rankRender.width,this.rankRender.height),this.loadLevelOpenRank()}},{key:"update",value:function(e){this.updateRankList()}},{key:"resizeSharedCanvas",value:function(e,t){if(window.wx){var i=window.wx.getOpenDataContext().canvas;i.width=e,i.height=t,console.log(i)}}},{key:"changeRender",value:function(e){"sprHorRank"===e.name?(this.rankListNode.active=!1,this.rankBgNode.active=!1):"sprRankList"===e.name&&(this.rankListNode.active=!0,this.rankBgNode.active=!0),this.rankRender.width=e.width,this.rankRender.height=e.height,this.rankRender.position=e.position,this.resizeSharedCanvas(e.width,e.height)}},{key:"updateRankList",value:function(){if(window.wx&&this.rankTexture){var e=window.wx.getOpenDataContext().canvas;this.rankTexture.uploadData(e),this.rankSpriteFrame.texture=this.rankTexture,this.rankRender.getComponent(a).spriteFrame=this.rankSpriteFrame}}},{key:"onEnable",value:function(){this.touchLayer.active=!0,this.enableScroll&&this.rankRender.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)}},{key:"onDisable",value:function(){this.enableScroll&&this.rankRender.off(cc.Node.EventType.TOUCH_MOVE)}},{key:"onViewDetailRank",value:function(){this.closeBackRank=1,this.loadLevelScoreRank(C.curLevel)}},{key:"onPageUp",value:function(){cc.log(this),this.postMessage("Paging",-1)}},{key:"onPageDown",value:function(){this.postMessage("Paging",1)}},{key:"onClose",value:function(){if(1===this.closeBackRank)return this.closeBackRank=0,void this.loadHorRank(C.curLevel);this.node.active=!1}},{key:"onTouchMove",value:function(e){var t=e.getDeltaY();this.postMessage("Scrolling",t)}},{key:"loadLevelScoreRank",value:function(e){this.node.active=!0,this.touchLayer.active=!0,this.onEnable(),this.changeRender(this.rankListNode),this.postMessage(w.DomainAction.FetchFriendScore,e)}},{key:"loadLevelOpenRank",value:function(){this.onEnable(),this.changeRender(this.rankListNode),this.postMessage(w.DomainAction.FetchFriendLevel,this.scale)}},{key:"loadHorRank",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.node.active=!0,this.touchLayer.active=!1,this.onDisable(),this.postMessage(w.DomainAction.HorConmpar,e,C.getScore(e))}},{key:"postMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(window.wx){var r=window.wx.getOpenDataContext();r.postMessage({action:e,data:t,dataEx:i})}}},{key:"uploadScore",value:function(e,t){window.wx&&(t=t.toString(),window.wx.setUserCloudStorage({KVDataList:[{key:w.OpenDataKeys.ScoreKey+e,value:t}],success:function(e){console.log("uploadScore success:res=>",e)},fail:function(e){console.log("uploadScore fail:res=>",e)}}))}},{key:"uploadLevelOpen",value:function(e){var t=this;console.log("uploadLevelOpen",e),window.window.wx&&(e=e.toString(),window.wx.setUserCloudStorage({KVDataList:[{key:w.OpenDataKeys.LevelKey,value:e}],success:function(e){console.log("uploadScore success:res=>",e),t.loadLevelOpenRank()},fail:function(e){console.log("uploadScore fail:res=>",e)}}))}},{key:"removeUserKey",value:function(e){window.window.wx&&("string"==typeof e&&(e=[e]),window.wx.removeUserCloudStorage({keyList:e,success:function(e){console.log("uploadScore success:res=>",e)},fail:function(e){console.log("uploadScore fail:res=>",e)}}))}},{key:"share",value:function(e){window.window.wx&&(e||(e={}),e.imageUrl=e.imageUrl||"http://img.zcool.cn/community/01c2ac57beb18d0000012e7eaa6d19.jpg@1280w_1l_2o_100sh.jpg",window.wx.shareAppMessage({title:"好多砖块啊，快来一起打",imageUrl:e.imageUrl,query:"key=testshare",success:function(t){console.log("success:",t),e.success&&e.success(t)},fail:function(t){console.log("fail:",t),e.fail&&e.fail(t)}}))}},{key:"setScale",value:function(e){this.scale=e,this.node.setScale(e)}},{key:"initRank",value:function(){}},{key:"snapshotSync",value:function(){if(window.wx){var e=cc.game.canvas,t=cc.winSize.width,i=cc.winSize.height;return e.toTempFilePathSync({x:0,y:0,width:1.5*t,height:i,destWidth:1.5*t,destHeight:i})}}}]),t}(r),v=babelHelpers.applyDecoratedDescriptor(h.prototype,"rankRender",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=babelHelpers.applyDecoratedDescriptor(h.prototype,"rankListNode",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=babelHelpers.applyDecoratedDescriptor(h.prototype,"rankBgNode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=babelHelpers.applyDecoratedDescriptor(h.prototype,"touchLayer",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=h))||b)),cc._RF.pop()}}})),System.register("project:///assets/scripts/lib/Action.ts",[],(function(e,t){return{setters:[],execute:function(){cc._RF.push(window.module||{},"a9278CdBPVO+4BRMAXZl/GP","Action"),e("default",new(function(){function e(){babelHelpers.classCallCheck(this,e),this.actions=[]}return babelHelpers.createClass(e,[{key:"addAction",value:function(e){var t=e.updateHandle,i=e.overHandle,r=e.time,n=void 0===r?.2:r,o=e.autoMove,a={updateHandle:t,overHandle:i,time:n,isMove:!1,curTime:0,autoMove:void 0===o||o,run:function(){this.curTime=0,this.isMove=!0}};return this.actions.push(a),a}},{key:"update",value:function(e){var t=[];this.actions.forEach((function(i,r){i.isMove&&(i.curTime+=e,i.curTime>i.time?(i.isMove=!1,i.autoMove&&t.push(r),i.overHandle&&i.overHandle()):i.updateHandle&&i.updateHandle(i.curTime/i.time,e))})),this.actions=this.actions.filter((function(e){return!t.includes(e)}))}}]),e}())),cc._RF.pop()}}})),System.register("project:///assets/scripts/lib/EventBus.ts",[],(function(e,t){var i;return{setters:[],execute:function(){cc._RF.push(window.module||{},"1e20aQ49d1G75DeKykxgKHt","EventBus"),e("EventBus",i=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"on",value:function(e,t){this.events[e]?this.events[e].push(t):this.events=[t]}},{key:"off",value:function(e,t){if(this.events[e]){var i=this.events.indexOf(t);-1!==i&&this.events.splice(i,1)}}},{key:"emit",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];if(this.events[e]){var n=this.events[e];n.forEach((function(e){e.apply(void 0,i)}))}}},{key:"once",value:function(e,t){var i=this;this.on(e,(function(){t(),i.off(e,t)}))}}]),e}()),i.events=[],cc._RF.pop()}}})),System.register("project:///assets/scripts/lib/InstanceMgr.ts",[],(function(e,t){return{setters:[],execute:function(){cc._RF.push(window.module||{},"768eeidDJpKLIU74lUCpMer","InstanceMgr"),e("InstanceMgr",function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"registerInstance",value:function(t,i){null!=e[t]?console.error(t,"is duplicate"):e[t]=i}}]),e}()),cc._RF.pop()}}})),System.register("project:///assets/scripts/lib/Utils.ts",[],(function(e,t){return{setters:[],execute:function(){var t,i;cc._RF.push(window.module||{},"f897bRkIuZP5JR4TyPf2ATj","Utils"),e("default",{showToast:(t=null,i=null,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500;t&&(document.body.removeChild(t),clearInterval(i));var n=document.createElement("div");n.style.cssText="\n                position: fixed;\n                left: 50%;\n                top: 50%;\n                transform: translate(-50%, -50%);\n            ";var o=document.createElement("span");o.style.cssText="\n                background: rgba(0, 0, 0, 0.7);\n                padding: 5px 10px;\n                font-size: 13px;\n                color: #fff;\n                border-radius: 5px;\n            ",o.innerText=e,n.appendChild(o),document.body.appendChild(n),t=n,i=setTimeout((function(){document.body.removeChild(t),t=null}),r)})}),cc._RF.pop()}}})),System.register("project:///assets/scripts/lib/TempConst.ts",["cc"],(function(e,t){var i,r,n;return e("parseTime2String",(function(e){var t=e%60,i=Math.floor(e/60),r=t>9?t.toString():"0"+t;return(i>9?i.toString():"0"+i)+":"+r})),{setters:[function(e){i=e.Vec3,r=e.Quat,n=e.Vec2}],execute:function(){cc._RF.push(window.module||{},"757b2P1g8ZJbYdr4Bb6L3wl","TempConst"),e("v2_t",new n),e("v3_t",new i),e("quat_t",new r),cc._RF.pop()}}})),System.register("project:///assets/scripts/gamePlay/UICtr.ts",["cc","../lib/InstanceMgr.ts","../config/KEY.ts","../config/MODE.ts","../lib/Utils.ts"],(function(e,t){var i,r,n,o,a,s,l,c,u,p,d,b,h,v,f,y,m,g,_,w,C,k,H,D,z,I,T,P,x,R,M,S,A,N,F,U,O,E,L,B,V,G,j,K,Y,W,J,Z,Q,q,X,$,ee,te;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_dec13:void 0,_dec14:void 0,_dec15:void 0,_dec16:void 0,_dec17:void 0,_dec18:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_descriptor12:void 0,_descriptor13:void 0,_descriptor14:void 0,_descriptor15:void 0,_descriptor16:void 0,_descriptor17:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,r=e.find,n=e.Component,o=e.Node,a=e.AnimationComponent,s=e.SystemEventType,l=e.LabelComponent,c=e.SpriteFrame,u=e.CameraComponent,p=e.Color,d=e.SpriteComponent},function(e){b=e.InstanceMgr},function(e){h=e.default},function(e){v=e.MODE},function(e){f=e.default}],execute:function(){cc._RF.push(window.module||{},"a637fCK/qhG+Y//Ok7nZjw0","UICtr"),ee=i.ccclass,te=i.property,e("UICtr",(y=ee("UICtr"),m=te({type:o}),g=te({type:o}),_=te({type:o}),w=te({type:o}),C=te({type:o}),k=te({type:o}),H=te({type:o}),D=te({type:o}),z=te({type:o}),I=te({type:o}),T=te({type:o}),P=te({type:c}),x=te({type:c}),R=te({type:c}),M=te({type:c}),S=te({type:c}),A=te({type:c}),y((F=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(n))),babelHelpers.initializerDefineProperty(i,"startUI",U,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"overtUI",O,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"btnNode",E,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"levelText",L,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"startBtn",B,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"restartBtn",V,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"voiceOpenNode",G,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"voiceCloseNode",j,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"coverNode",K,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"rankRenderNode",Y,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"rankWrap",W,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"title_black",J,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"title_white",Z,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"mode_moon",Q,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"mode_sun",q,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"mode_moon_icon",X,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"mode_sun_icon",$,babelHelpers.assertThisInitialized(i)),i._btnAni=null,i.mode="black",i.theme=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onLoad",value:function(){b.registerInstance("UICtr",this),this._btnAni=this.btnNode.getComponent(a)}},{key:"start",value:function(){var e=this;this.coverNode.on(s.TOUCH_START,(function(){e.hideSub()})),this.rankWrap.on(s.TOUCH_START,(function(){console.log("click = rankWrap")})),this.init()}},{key:"init",value:function(){var e=!!localStorage.getItem(h.IS_VOICE);this.toogleVoiceIcon(e);var t=localStorage.getItem(h.MODE);t&&(this.mode=t),this.theme=v[this.mode],this.initModeUI()}},{key:"initModeUI",value:function(e){cc.find("Camera").getComponent(u).color=new p(this.theme.bg),r("Title/best",this.startUI).getComponent(l).color=new p(this.theme.level),this.startUI.getChildByName("Title").getComponent(d).spriteFrame=this["title_"+this.mode],this.levelText.getComponent(l).color=new p(this.theme.level);var t=this.btnNode.getChildByName("mode"),i=cc.find("items/mode/wrap/icon",this.overtUI);"white"===this.mode?(t.getComponent(d).spriteFrame=this.mode_moon,i.getComponent(d).spriteFrame=this.mode_moon_icon):"black"===this.mode&&(t.getComponent(d).spriteFrame=this.mode_sun,i.getComponent(d).spriteFrame=this.mode_sun_icon),b.GameCtr.modeChange(this.theme,e)}},{key:"showStartUI",value:function(){this.overtUI.active=!1,this.startUI.active=!0,this.levelText.active=!1,this.startBtn.active=!0,this.restartBtn.active=!1,this.showBtn()}},{key:"hideStartUI",value:function(){this.levelText.active=!0,this.startUI.active=!1,this.hideBtn()}},{key:"showOverUI",value:function(){var e=this;this.startUI.active=!1,this.overtUI.active=!0,this.restartBtn.active=!0,this.startBtn.active=!1,this.overtUI.getComponent(a).play("showOver"),setTimeout((function(){e.showBtn()}),600)}},{key:"hideOverUI",value:function(){var e=this;this.levelText.active=!0;var t=this.overtUI.getComponent(a);t.play("hideItems2"),t.once("stop",(function(){e.overtUI.active=!1})),this.hideBtn()}},{key:"showBtn",value:function(){this._btnAni.play(),this.btnNode.active=!0}},{key:"hideBtn",value:function(){this.btnNode.active=!1}},{key:"initLevelTitle",value:function(e){this.levelText.getComponent(l).string="".concat(e),r("top/best/wrap/num",this.overtUI).getComponent(l).string="".concat(e),r("Title/best",this.startUI).getComponent(l).string="关卡：".concat(e)}},{key:"toogleVoiceIcon",value:function(e){this.voiceCloseNode.active=e,this.voiceOpenNode.active=!e}},{key:"showCover",value:function(){this.coverNode.active=!0}},{key:"hideCover",value:function(){this.coverNode.active=!1}},{key:"showSub",value:function(){window.wx?(this.rankRenderNode.active=!0,this.rankRenderNode.getComponent(a).play(),window.wx.getOpenDataContext().postMessage({action:"update"})):f.showToast("当前平台暂不支持使用")}},{key:"showShare",value:function(){window.wx||f.showToast("当前平台暂不支持使用")}},{key:"hideSub",value:function(){console.log("hideSub"),this.hideCover(),this.rankRenderNode.active=!1}},{key:"toogleMode",value:function(){b.GameCtr.isBuilding||(b.MusicCtr.play("click"),"white"===this.mode?this.mode="black":"black"===this.mode&&(this.mode="white"),localStorage.setItem(h.MODE,this.mode),this.theme=v[this.mode],this.initModeUI(!0))}},{key:"btnClick",value:function(e,t){var i=e.currentTarget.getComponent(a);"rank"==t?this.showSub():"share"==t?this.showShare():"mode"==t&&this.toogleMode(),i.play()}},{key:"itemClick",value:function(e,t){var i=e.currentTarget.getComponent(a);1==t&&this.toogleMode(),i.play()}}]),t}(n),U=babelHelpers.applyDecoratedDescriptor(F.prototype,"startUI",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=babelHelpers.applyDecoratedDescriptor(F.prototype,"overtUI",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=babelHelpers.applyDecoratedDescriptor(F.prototype,"btnNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=babelHelpers.applyDecoratedDescriptor(F.prototype,"levelText",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=babelHelpers.applyDecoratedDescriptor(F.prototype,"startBtn",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=babelHelpers.applyDecoratedDescriptor(F.prototype,"restartBtn",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=babelHelpers.applyDecoratedDescriptor(F.prototype,"voiceOpenNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=babelHelpers.applyDecoratedDescriptor(F.prototype,"voiceCloseNode",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=babelHelpers.applyDecoratedDescriptor(F.prototype,"coverNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=babelHelpers.applyDecoratedDescriptor(F.prototype,"rankRenderNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=babelHelpers.applyDecoratedDescriptor(F.prototype,"rankWrap",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=babelHelpers.applyDecoratedDescriptor(F.prototype,"title_black",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=babelHelpers.applyDecoratedDescriptor(F.prototype,"title_white",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=babelHelpers.applyDecoratedDescriptor(F.prototype,"mode_moon",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=babelHelpers.applyDecoratedDescriptor(F.prototype,"mode_sun",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=babelHelpers.applyDecoratedDescriptor(F.prototype,"mode_moon_icon",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=babelHelpers.applyDecoratedDescriptor(F.prototype,"mode_sun_icon",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=F))||N)),cc._RF.pop()}}}))}}}));
